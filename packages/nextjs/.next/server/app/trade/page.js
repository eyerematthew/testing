(()=>{var e={};e.id=3687,e.ids=[3687],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8086:e=>{"use strict";e.exports=require("module")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},12412:e=>{"use strict";e.exports=require("assert")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31556:(e,t,r)=>{Promise.resolve().then(r.bind(r,95408))},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},54729:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>w});var s=r(47818),a=r(22195),l=r(70336),n=r(11043),i=r(3977),o=r.n(i),d=r(1990),u=r(91531),c=r(63924),x=r(85058);let p=process.env.NEXT_PUBLIC_OTC_MARKETPLACE_ADDRESS||"",m=["function createBuyOrder(address assetAddress, tuple(bytes,bytes) amount, tuple(bytes,bytes) price, tuple(bytes,bytes) minFillAmount, bytes inputProof, uint256 expirationTime) external returns (uint256)","function createSellOrder(address assetAddress, tuple(bytes,bytes) amount, tuple(bytes,bytes) price, tuple(bytes,bytes) minFillAmount, bytes inputProof, uint256 expirationTime) external returns (uint256)"];function b(){let{address:e}=(0,l.F)(),t=(0,u.N)(),{canEncrypt:r,encryptWith:n}=(0,d.W6)(),[i,o]=(0,a.useState)("buy"),[b,h]=(0,a.useState)(""),[g,f]=(0,a.useState)(""),[y,v]=(0,a.useState)(""),[j,w]=(0,a.useState)(""),[N,S]=(0,a.useState)("7"),[k,C]=(0,a.useState)(!1),[P,q]=(0,a.useState)(""),[O,_]=(0,a.useState)(""),A=async s=>{if(s.preventDefault(),_(""),q(""),!t||!e||!r){_("Please connect wallet and wait for encryption to be ready");return}if(!c.PW(b)){_("Invalid asset address");return}C(!0);try{let e=Math.floor(1e18*parseFloat(g)),r=Math.floor(1e18*parseFloat(y)),s=Math.floor(1e18*parseFloat(j)),a=await n(t=>{t.add64(e),t.add64(r),t.add64(s)}),l=Math.floor(Date.now()/1e3)+86400*parseInt(N),o=new x.NZ(p,m,t),d="buy"===i?await o.createBuyOrder(b,a.handles[0],a.handles[1],a.handles[2],a.inputProof,l):await o.createSellOrder(b,a.handles[0],a.handles[1],a.handles[2],a.inputProof,l);q(d.hash),await d.wait(),h(""),f(""),v(""),w("")}catch(e){_(e.message||"Transaction failed")}finally{C(!1)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,s.jsx)("button",{onClick:()=>o("buy"),className:`flex-1 px-6 py-3 rounded-lg font-semibold transition-colors ${"buy"===i?"bg-green-600 text-white":"bg-slate-700 text-gray-400 hover:text-white"}`,children:"Buy Order"}),(0,s.jsx)("button",{onClick:()=>o("sell"),className:`flex-1 px-6 py-3 rounded-lg font-semibold transition-colors ${"sell"===i?"bg-red-600 text-white":"bg-slate-700 text-gray-400 hover:text-white"}`,children:"Sell Order"})]}),(0,s.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Asset Address"}),(0,s.jsx)("input",{type:"text",value:b,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-purple-500",placeholder:"0x...",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Amount"}),(0,s.jsx)("input",{type:"number",step:"0.000001",value:g,onChange:e=>f(e.target.value),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-purple-500",placeholder:"0.0",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Price"}),(0,s.jsx)("input",{type:"number",step:"0.000001",value:y,onChange:e=>v(e.target.value),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-purple-500",placeholder:"0.0",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Minimum Fill Amount"}),(0,s.jsx)("input",{type:"number",step:"0.000001",value:j,onChange:e=>w(e.target.value),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-purple-500",placeholder:"0.0",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Expiration (days)"}),(0,s.jsx)("input",{type:"number",min:"1",value:N,onChange:e=>S(e.target.value),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-purple-500",required:!0})]}),O&&(0,s.jsx)("div",{className:"p-4 bg-red-500/10 border border-red-500 rounded-lg text-red-400",children:O}),P&&(0,s.jsxs)("div",{className:"p-4 bg-green-500/10 border border-green-500 rounded-lg text-green-400",children:["Transaction submitted: ",P.slice(0,10),"..."]}),(0,s.jsx)("button",{type:"submit",disabled:k||!r,className:"w-full px-6 py-4 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-700 disabled:text-gray-500 text-white rounded-lg font-semibold transition-colors",children:k?"Creating Order...":`Create ${"buy"===i?"Buy":"Sell"} Order`})]})]})}let h=process.env.NEXT_PUBLIC_OTC_MARKETPLACE_ADDRESS||"",g=["function getOrder(uint256 orderId) external view returns (uint256, address, address, tuple(bytes,bytes), tuple(bytes,bytes), tuple(bytes,bytes), bool, uint256, uint256)","function orderCounter() external view returns (uint256)"];function f(){let{address:e}=(0,l.F)(),t=(0,u.N)(),[r,n]=(0,a.useState)([]),[i,o]=(0,a.useState)(!1),[d,c]=(0,a.useState)("all"),p=async()=>{if(t){o(!0);try{let e=new x.NZ(h,g,t),r=await e.orderCounter(),s=Number(r),a=[];for(let t=0;t<Math.min(s,50);t++)a.push(e.getOrder(t).catch(()=>null));let l=(await Promise.all(a)).map((e,t)=>e?{orderId:t,owner:e[1],asset:e[2],isBuy:e[6],expiration:Number(e[7]),created:Number(e[8])}:null).filter(e=>null!==e);n(l)}catch(e){console.error("Failed to load orders",e)}finally{o(!1)}}},m=r.filter(e=>"all"===d||("buy"===d?e.isBuy:"sell"!==d||!e.isBuy));return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{onClick:()=>c("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${"all"===d?"bg-purple-600 text-white":"bg-slate-700 text-gray-400 hover:text-white"}`,children:"All Orders"}),(0,s.jsx)("button",{onClick:()=>c("buy"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${"buy"===d?"bg-green-600 text-white":"bg-slate-700 text-gray-400 hover:text-white"}`,children:"Buy Orders"}),(0,s.jsx)("button",{onClick:()=>c("sell"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${"sell"===d?"bg-red-600 text-white":"bg-slate-700 text-gray-400 hover:text-white"}`,children:"Sell Orders"}),(0,s.jsx)("button",{onClick:p,className:"ml-auto px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:"Refresh"})]}),i?(0,s.jsx)("div",{className:"text-center py-12 text-gray-400",children:"Loading orders..."}):0===m.length?(0,s.jsx)("div",{className:"text-center py-12 text-gray-400",children:"No orders found"}):(0,s.jsx)("div",{className:"space-y-3",children:m.map(e=>(0,s.jsx)("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4 hover:border-purple-500 transition-colors",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${e.isBuy?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:e.isBuy?"BUY":"SELL"}),(0,s.jsxs)("span",{className:"text-gray-400 text-sm",children:["Order #",e.orderId]})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:[(0,s.jsxs)("div",{children:["Asset: ",e.asset.slice(0,10),"...",e.asset.slice(-8)]}),(0,s.jsxs)("div",{children:["Owner: ",e.owner.slice(0,10),"...",e.owner.slice(-8)]})]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:["Expires: ",new Date(1e3*e.expiration).toLocaleDateString()]})})]})},e.orderId))})]})}let y=process.env.NEXT_PUBLIC_OTC_MARKETPLACE_ADDRESS||"",v=["function matchOrders(uint256 buyOrderId, uint256 sellOrderId, tuple(bytes,bytes) fillAmount, bytes inputProof) external returns (uint256)","function executeSettlement(uint256 matchId, tuple(bytes,bytes) feeAmount, bytes inputProof) external"];function j(){let{address:e}=(0,l.F)(),t=(0,u.N)(),{canEncrypt:r,encryptWith:n}=(0,d.W6)(),[i,o]=(0,a.useState)(""),[c,p]=(0,a.useState)(""),[m,b]=(0,a.useState)(""),[h,g]=(0,a.useState)(!1),[f,j]=(0,a.useState)(""),[w,N]=(0,a.useState)(""),[S,k]=(0,a.useState)(""),[C,P]=(0,a.useState)(""),[q,O]=(0,a.useState)(!1),_=async s=>{if(s.preventDefault(),k(""),N(""),!t||!e||!r){k("Please connect wallet and wait for encryption to be ready");return}g(!0);try{let e=Math.floor(1e18*parseFloat(m)),r=await n(t=>{t.add64(e)}),s=new x.NZ(y,v,t),a=await s.matchOrders(parseInt(i),parseInt(c),r.handles[0],r.inputProof);N(a.hash);let l=(await a.wait()).logs.find(e=>{try{let t=s.interface.parseLog(e);return t?.name==="OrderMatched"}catch{return!1}});if(l){let e=s.interface.parseLog(l);j(e?.args[0].toString()||"")}o(""),p(""),b("")}catch(e){k(e.message||"Transaction failed")}finally{g(!1)}},A=async s=>{if(s.preventDefault(),k(""),!t||!e||!r){k("Please connect wallet");return}if(!f){k("No match ID available");return}O(!0);try{let e=Math.floor(1e18*parseFloat(C)),r=await n(t=>{t.add64(e)}),s=new x.NZ(y,v,t),a=await s.executeSettlement(parseInt(f),r.handles[0],r.inputProof);await a.wait(),j(""),P("")}catch(e){k(e.message||"Settlement failed")}finally{O(!1)}};return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Match Orders"}),(0,s.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Buy Order ID"}),(0,s.jsx)("input",{type:"number",value:i,onChange:e=>o(e.target.value),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-purple-500",placeholder:"0",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Sell Order ID"}),(0,s.jsx)("input",{type:"number",value:c,onChange:e=>p(e.target.value),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-purple-500",placeholder:"0",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Fill Amount"}),(0,s.jsx)("input",{type:"number",step:"0.000001",value:m,onChange:e=>b(e.target.value),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-purple-500",placeholder:"0.0",required:!0})]}),S&&(0,s.jsx)("div",{className:"p-4 bg-red-500/10 border border-red-500 rounded-lg text-red-400",children:S}),w&&(0,s.jsxs)("div",{className:"p-4 bg-green-500/10 border border-green-500 rounded-lg text-green-400",children:["Transaction: ",w.slice(0,10),"...",f&&(0,s.jsxs)("div",{className:"mt-2",children:["Match ID: ",f]})]}),(0,s.jsx)("button",{type:"submit",disabled:h||!r,className:"w-full px-6 py-4 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-700 disabled:text-gray-500 text-white rounded-lg font-semibold transition-colors",children:h?"Matching...":"Match Orders"})]})]}),f&&(0,s.jsxs)("div",{className:"border-t border-slate-700 pt-8",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Settle Match"}),(0,s.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Match ID"}),(0,s.jsx)("input",{type:"text",value:f,disabled:!0,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-gray-400"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Fee Amount"}),(0,s.jsx)("input",{type:"number",step:"0.000001",value:C,onChange:e=>P(e.target.value),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-purple-500",placeholder:"0.0",required:!0})]}),(0,s.jsx)("button",{type:"submit",disabled:q||!r,className:"w-full px-6 py-4 bg-green-600 hover:bg-green-700 disabled:bg-slate-700 disabled:text-gray-500 text-white rounded-lg font-semibold transition-colors",children:q?"Settling...":"Execute Settlement"})]})]})]})}function w(){let{isConnected:e}=(0,l.F)(),[t,r]=(0,a.useState)("create");return e?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("nav",{className:"flex justify-between items-center mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-8",children:[(0,s.jsx)(o(),{href:"/",className:"text-2xl font-bold text-white",children:"Private OTC"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(o(),{href:"/trade",className:"text-purple-400 font-semibold",children:"Trade"}),(0,s.jsx)(o(),{href:"/dashboard",className:"text-gray-400 hover:text-white",children:"Dashboard"}),(0,s.jsx)(o(),{href:"/portfolio",className:"text-gray-400 hover:text-white",children:"Portfolio"})]})]}),(0,s.jsx)(n.pK,{})]}),(0,s.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,s.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700 overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex border-b border-slate-700",children:[(0,s.jsx)("button",{onClick:()=>r("create"),className:`flex-1 px-6 py-4 font-semibold transition-colors ${"create"===t?"bg-purple-600 text-white":"text-gray-400 hover:text-white"}`,children:"Create Order"}),(0,s.jsx)("button",{onClick:()=>r("match"),className:`flex-1 px-6 py-4 font-semibold transition-colors ${"match"===t?"bg-purple-600 text-white":"text-gray-400 hover:text-white"}`,children:"Match Orders"}),(0,s.jsx)("button",{onClick:()=>r("book"),className:`flex-1 px-6 py-4 font-semibold transition-colors ${"book"===t?"bg-purple-600 text-white":"text-gray-400 hover:text-white"}`,children:"Order Book"})]}),(0,s.jsxs)("div",{className:"p-8",children:["create"===t&&(0,s.jsx)(b,{}),"match"===t&&(0,s.jsx)(j,{}),"book"===t&&(0,s.jsx)(f,{})]})]})})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold text-white mb-4",children:"Connect Wallet"}),(0,s.jsx)("p",{className:"text-gray-400 mb-8",children:"Please connect your wallet to access trading"}),(0,s.jsx)(n.pK,{})]})})}},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},61412:(e,t,r)=>{Promise.resolve().then(r.bind(r,54729))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},95408:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(75884).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/matt24/private-otc-marketplace/packages/nextjs/app/trade/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/matt24/private-otc-marketplace/packages/nextjs/app/trade/page.tsx","default")},99998:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>c,pages:()=>u,routeModule:()=>x,tree:()=>d});var s=r(12208),a=r(93295),l=r(38311),n=r.n(l),i=r(95192),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let d={children:["",{children:["trade",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,95408)),"/home/matt24/private-otc-marketplace/packages/nextjs/app/trade/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,81686)),"/home/matt24/private-otc-marketplace/packages/nextjs/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,25733,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,73960,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,25321,23)),"next/dist/client/components/unauthorized-error"]}]}.children,u=["/home/matt24/private-otc-marketplace/packages/nextjs/app/trade/page.tsx"],c={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/trade/page",pathname:"/trade",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[2821,3977,4128,2112,3077],()=>r(99998));module.exports=s})();